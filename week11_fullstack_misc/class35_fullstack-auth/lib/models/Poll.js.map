{"version":3,"sources":["../../src/models/Poll.js"],"names":["pollSchema","Schema","title","type","String","required","candidates","name","methods","results","model","aggregate","$match","pollId","_id","$unwind","$group","candidateId","candidateName","avgVote","$avg","$project"],"mappings":";;;;;;;AAAA;;AAEA,IAAMA,UAAU,GAAG,IAAIC,gBAAJ,CAAW;AAC5BC,EAAAA,KAAK,EAAE;AACLC,IAAAA,IAAI,EAAEC,MADD;AAELC,IAAAA,QAAQ,EAAE;AAFL,GADqB;AAK5BC,EAAAA,UAAU,EAAE;AACVH,IAAAA,IAAI,EAAE,CAAC;AAAEI,MAAAA,IAAI,EAAEH;AAAR,KAAD;AADI;AALgB,CAAX,CAAnB;;AAUAJ,UAAU,CAACQ,OAAX,CAAmBC,OAAnB,GAA6B,YAAY;AACvC,SAAO,KAAKC,KAAL,CAAW,MAAX,EAAmBC,SAAnB,CAA6B,CAClC;AAAEC,IAAAA,MAAM,EAAE;AAAEC,MAAAA,MAAM,EAAE,KAAKC;AAAf;AAAV,GADkC,EAElC;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAFkC,EAGlC;AACEC,IAAAA,MAAM,EAAE;AACNF,MAAAA,GAAG,EAAE;AACHG,QAAAA,WAAW,EAAE,oBADV;AAEHC,QAAAA,aAAa,EAAE;AAFZ,OADC;AAKNC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,IAAI,EAAE;AAAR;AALH;AADV,GAHkC,EAYlC;AAAEC,IAAAA,QAAQ,EAAE;AAAEP,MAAAA,GAAG,EAAE,KAAP;AAAcI,MAAAA,aAAa,EAAE,oBAA7B;AAAmDD,MAAAA,WAAW,EAAE,kBAAhE;AAAoFE,MAAAA,OAAO,EAAE;AAA7F;AAAZ,GAZkC,CAA7B,CAAP;AAcD,CAfD;;eAiBe,qBAAM,MAAN,EAAcnB,UAAd,C","sourcesContent":["import { Schema, model } from 'mongoose';\n\nconst pollSchema = new Schema({\n  title: {\n    type: String,\n    required: true\n  },\n  candidates: {\n    type: [{ name: String }]\n  }\n});\n\npollSchema.methods.results = function () {\n  return this.model('Vote').aggregate([\n    { $match: { pollId: this._id } },\n    { $unwind: '$votes' },\n    {\n      $group: {\n        _id: {\n          candidateId: '$votes.candidateId',\n          candidateName: '$votes.candidateName'\n        },\n        avgVote: { $avg: '$votes.vote' }\n      }\n    },\n    { $project: { _id: false, candidateName: '$_id.candidateName', candidateId: '$_id.candidateId', avgVote: '$avgVote' } }\n  ]);\n};\n\nexport default model('Poll', pollSchema);\n"],"file":"Poll.js"}