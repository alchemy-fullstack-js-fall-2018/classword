{"version":3,"sources":["../../src/utils/connect.js"],"names":["log","event","dbUrl","console","toUpperCase","redactURLAuth","url","parsedUrl","redactedAuth","auth","protocol","hostname","port","path","module","exports","process","env","MONGODB_URI","mongoose","connect","useNewUrlParser","redactedUrl","connection","on"],"mappings":";;AAAA;;AACA;;;;AAEA,IAAMA,GAAG,GAAG,SAANA,GAAM,CAACC,KAAD,EAAQC,KAAR,EAAkB;AAC5B,SAAO,YAAM;AACX;AACAC,IAAAA,OAAO,CAACH,GAAR,WAAeC,KAAK,CAACG,WAAN,EAAf,6BAAqDF,KAArD;AACD,GAHD;AAID,CALD;;AAOA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,GAAG,EAAI;AAC3B,MAAMC,SAAS,GAAG,gBAAMD,GAAN,CAAlB;AACA,MAAME,YAAY,GAAGD,SAAS,CAACE,IAAV,GAAiB,UAAjB,GAA8B,EAAnD;AACA,mBAAUF,SAAS,CAACG,QAApB,eAAiCF,YAAjC,SAAgDD,SAAS,CAACI,QAA1D,cAAsEJ,SAAS,CAACK,IAAhF,SAAuFL,SAAS,CAACM,IAAjG;AACD,CAJD;;AAMAC,MAAM,CAACC,OAAP,GAAiB,YAAqC;AAAA,MAApCb,KAAoC,uEAA5Bc,OAAO,CAACC,GAAR,CAAYC,WAAgB;;AACpDC,oBAASC,OAAT,CAAiBlB,KAAjB,EAAwB;AAAEmB,IAAAA,eAAe,EAAE;AAAnB,GAAxB;;AAEA,MAAMC,WAAW,GAAGjB,aAAa,CAACH,KAAD,CAAjC;;AAEAiB,oBAASI,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgCxB,GAAG,CAAC,OAAD,EAAUsB,WAAV,CAAnC;;AAEAH,oBAASI,UAAT,CAAoBC,EAApB,CAAuB,MAAvB,EAA+BxB,GAAG,CAAC,MAAD,EAASsB,WAAT,CAAlC;;AAEAH,oBAASI,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgCxB,GAAG,CAAC,OAAD,EAAUsB,WAAV,CAAnC;AACD,CAVD","sourcesContent":["import { parse } from 'url';\nimport mongoose from 'mongoose';\n\nconst log = (event, dbUrl) => {\n  return () => {\n    // eslint-disable-next-line no-console\n    console.log(`${event.toUpperCase()}: connection to ${dbUrl}`);\n  };\n};\n\nconst redactURLAuth = url => {\n  const parsedUrl = parse(url);\n  const redactedAuth = parsedUrl.auth ? '***:***@' : '';\n  return `${parsedUrl.protocol}//${redactedAuth}${parsedUrl.hostname}:${parsedUrl.port}${parsedUrl.path}`;\n};\n\nmodule.exports = (dbUrl = process.env.MONGODB_URI) => {\n  mongoose.connect(dbUrl, { useNewUrlParser: true });\n\n  const redactedUrl = redactURLAuth(dbUrl);\n\n  mongoose.connection.on('error', log('error', redactedUrl));\n\n  mongoose.connection.on('open', log('open', redactedUrl));\n\n  mongoose.connection.on('close', log('close', redactedUrl));\n};\n"],"file":"connect.js"}